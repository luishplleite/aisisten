<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Cadastro de Revendedor - TimePulse AI</title>
    
    <meta http-equiv="Cache-Control" content="no-cache, no-store, must-revalidate">
    <meta http-equiv="Pragma" content="no-cache">
    <meta http-equiv="Expires" content="0">
    
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.4.0/css/all.min.css">
</head>
<body>
<style>
    * {
        margin: 0;
        padding: 0;
        box-sizing: border-box;
    }

    body {
        font-family: 'Inter', sans-serif;
        background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        min-height: 100vh;
        padding: 2rem;
    }

    .cadastro-container {
        max-width: 800px;
        margin: 0 auto;
        background: white;
        border-radius: 20px;
        box-shadow: 0 20px 60px rgba(0,0,0,0.3);
        overflow: hidden;
        animation: slideIn 0.5s ease;
    }

    @keyframes slideIn {
        from {
            opacity: 0;
            transform: translateY(-30px);
        }
        to {
            opacity: 1;
            transform: translateY(0);
        }
    }

    .cadastro-header {
        background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        color: white;
        padding: 3rem 2rem;
        text-align: center;
    }

    .cadastro-logo {
        font-size: 3rem;
        margin-bottom: 0.5rem;
    }

    .cadastro-title {
        font-size: 2rem;
        font-weight: 700;
        margin-bottom: 0.5rem;
    }

    .cadastro-subtitle {
        font-size: 1.1rem;
        opacity: 0.9;
    }

    .cadastro-body {
        padding: 3rem 2.5rem;
    }

    .form-section {
        margin-bottom: 2.5rem;
    }

    .section-title {
        font-size: 1.3rem;
        font-weight: 600;
        color: #2c3e50;
        margin-bottom: 1.5rem;
        padding-bottom: 0.75rem;
        border-bottom: 2px solid #667eea;
        display: flex;
        align-items: center;
        gap: 0.75rem;
    }

    .section-title i {
        color: #667eea;
    }

    .form-grid {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
        gap: 1.5rem;
    }

    .form-group {
        margin-bottom: 1.5rem;
    }

    .form-label {
        display: block;
        margin-bottom: 0.5rem;
        color: #2c3e50;
        font-weight: 500;
        font-size: 0.95rem;
    }

    .form-label .required {
        color: #e74c3c;
    }

    .form-input,
    .form-select {
        width: 100%;
        padding: 0.875rem 1rem;
        border: 2px solid #e1e8ed;
        border-radius: 10px;
        font-size: 1rem;
        transition: all 0.3s ease;
        font-family: 'Inter', sans-serif;
    }

    .form-input:focus,
    .form-select:focus {
        outline: none;
        border-color: #667eea;
        box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.1);
    }

    .btn-cadastrar {
        width: 100%;
        padding: 1.25rem;
        background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        color: white;
        border: none;
        border-radius: 10px;
        font-size: 1.2rem;
        font-weight: 600;
        cursor: pointer;
        transition: all 0.3s ease;
        margin-top: 2rem;
    }

    .btn-cadastrar:hover {
        transform: translateY(-2px);
        box-shadow: 0 10px 25px rgba(102, 126, 234, 0.3);
    }

    .btn-cadastrar:disabled {
        opacity: 0.6;
        cursor: not-allowed;
        transform: none;
    }

    .cadastro-footer {
        text-align: center;
        padding: 2rem;
        background: #f8f9fa;
        border-top: 1px solid #e9ecef;
    }

    .cadastro-footer a {
        color: #667eea;
        text-decoration: none;
        font-weight: 500;
        transition: all 0.3s ease;
    }

    .cadastro-footer a:hover {
        color: #764ba2;
        text-decoration: underline;
    }

    .alert {
        padding: 1.25rem;
        border-radius: 10px;
        margin-bottom: 2rem;
        display: none;
    }

    .alert.show {
        display: block;
        animation: slideDown 0.3s ease;
    }

    @keyframes slideDown {
        from {
            opacity: 0;
            transform: translateY(-10px);
        }
        to {
            opacity: 1;
            transform: translateY(0);
        }
    }

    .alert-danger {
        background: #f8d7da;
        color: #721c24;
        border: 1px solid #f5c6cb;
    }

    .alert-success {
        background: #d4edda;
        color: #155724;
        border: 1px solid #c3e6cb;
    }

    .loading {
        display: none;
        text-align: center;
        padding: 2rem;
    }

    .loading.show {
        display: block;
    }

    .spinner {
        border: 4px solid #f3f3f3;
        border-top: 4px solid #667eea;
        border-radius: 50%;
        width: 50px;
        height: 50px;
        animation: spin 1s linear infinite;
        margin: 0 auto;
    }

    @keyframes spin {
        0% { transform: rotate(0deg); }
        100% { transform: rotate(360deg); }
    }
</style>

<div class="cadastro-container">
    <div class="cadastro-header">
        <div class="cadastro-logo">
            <i class="fas fa-user-plus"></i>
        </div>
        <h1 class="cadastro-title">Cadastro de Revendedor</h1>
        <p class="cadastro-subtitle">Preencha os dados abaixo para se tornar um revendedor TimePulse AI</p>
    </div>

    <div class="cadastro-body">
        <div id="alert" class="alert"></div>
        <div id="loading" class="loading">
            <div class="spinner"></div>
            <p style="margin-top: 1rem; color: #667eea; font-weight: 600;">Processando cadastro...</p>
        </div>

        <form id="cadastroForm">
            <div class="form-section">
                <h2 class="section-title">
                    <i class="fas fa-user"></i>
                    Dados Pessoais
                </h2>
                <div class="form-grid">
                    <div class="form-group">
                        <label class="form-label" for="name">
                            Nome Completo <span class="required">*</span>
                        </label>
                        <input type="text" id="name" name="name" class="form-input" required>
                    </div>

                    <div class="form-group">
                        <label class="form-label" for="email">
                            Email <span class="required">*</span>
                        </label>
                        <input type="email" id="email" name="email" class="form-input" required>
                    </div>

                    <div class="form-group">
                        <label class="form-label" for="phone">
                            Telefone <span class="required">*</span>
                        </label>
                        <input type="tel" id="phone" name="phone" class="form-input" placeholder="(00) 00000-0000" required>
                    </div>

                    <div class="form-group">
                        <label class="form-label" for="birthDate">
                            Data de Nascimento <span class="required">*</span>
                        </label>
                        <input type="date" id="birthDate" name="birthDate" class="form-input" required>
                    </div>

                    <div class="form-group">
                        <label class="form-label" for="personType">
                            Tipo de Pessoa <span class="required">*</span>
                        </label>
                        <select id="personType" name="personType" class="form-select" required>
                            <option value="">Selecione...</option>
                            <option value="FISICA">Pessoa Física</option>
                            <option value="JURIDICA">Pessoa Jurídica</option>
                        </select>
                    </div>

                    <div class="form-group">
                        <label class="form-label" for="cpfCnpj">
                            CPF/CNPJ <span class="required">*</span>
                        </label>
                        <input type="text" id="cpfCnpj" name="cpfCnpj" class="form-input" placeholder="000.000.000-00" required>
                    </div>
                </div>
            </div>

            <div class="form-section">
                <h2 class="section-title">
                    <i class="fas fa-map-marker-alt"></i>
                    Endereço
                </h2>
                <div class="form-grid">
                    <div class="form-group">
                        <label class="form-label" for="postalCode">
                            CEP <span class="required">*</span>
                        </label>
                        <input type="text" id="postalCode" name="postalCode" class="form-input" placeholder="00000-000" required>
                    </div>

                    <div class="form-group">
                        <label class="form-label" for="address">
                            Endereço <span class="required">*</span>
                        </label>
                        <input type="text" id="address" name="address" class="form-input" required>
                    </div>

                    <div class="form-group">
                        <label class="form-label" for="addressNumber">
                            Número <span class="required">*</span>
                        </label>
                        <input type="text" id="addressNumber" name="addressNumber" class="form-input" required>
                    </div>

                    <div class="form-group">
                        <label class="form-label" for="complement">
                            Complemento
                        </label>
                        <input type="text" id="complement" name="complement" class="form-input">
                    </div>

                    <div class="form-group">
                        <label class="form-label" for="city">
                            Cidade <span class="required">*</span>
                        </label>
                        <input type="text" id="city" name="city" class="form-input" required>
                    </div>

                    <div class="form-group">
                        <label class="form-label" for="state">
                            Estado <span class="required">*</span>
                        </label>
                        <select id="state" name="state" class="form-select" required>
                            <option value="">Selecione...</option>
                            <option value="AC">Acre</option>
                            <option value="AL">Alagoas</option>
                            <option value="AP">Amapá</option>
                            <option value="AM">Amazonas</option>
                            <option value="BA">Bahia</option>
                            <option value="CE">Ceará</option>
                            <option value="DF">Distrito Federal</option>
                            <option value="ES">Espírito Santo</option>
                            <option value="GO">Goiás</option>
                            <option value="MA">Maranhão</option>
                            <option value="MT">Mato Grosso</option>
                            <option value="MS">Mato Grosso do Sul</option>
                            <option value="MG">Minas Gerais</option>
                            <option value="PA">Pará</option>
                            <option value="PB">Paraíba</option>
                            <option value="PR">Paraná</option>
                            <option value="PE">Pernambuco</option>
                            <option value="PI">Piauí</option>
                            <option value="RJ">Rio de Janeiro</option>
                            <option value="RN">Rio Grande do Norte</option>
                            <option value="RS">Rio Grande do Sul</option>
                            <option value="RO">Rondônia</option>
                            <option value="RR">Roraima</option>
                            <option value="SC">Santa Catarina</option>
                            <option value="SP">São Paulo</option>
                            <option value="SE">Sergipe</option>
                            <option value="TO">Tocantins</option>
                        </select>
                    </div>

                    <div class="form-group">
                        <label class="form-label" for="country">
                            País <span class="required">*</span>
                        </label>
                        <input type="text" id="country" name="country" class="form-input" value="Brasil" required>
                    </div>
                </div>
            </div>

            <button type="submit" class="btn-cadastrar">
                <i class="fas fa-check-circle"></i> Cadastrar Revendedor
            </button>
        </form>
    </div>

    <div class="cadastro-footer">
        <p>Já possui cadastro?</p>
        <a href="loginrevenda.html">
            <i class="fas fa-sign-in-alt"></i> Faça login aqui
        </a>
    </div>
</div>

<script>
    const cadastroForm = document.getElementById('cadastroForm');
    const alertDiv = document.getElementById('alert');
    const loadingDiv = document.getElementById('loading');

    function showAlert(message, type = 'danger') {
        alertDiv.innerHTML = message;
        alertDiv.className = `alert alert-${type} show`;
        window.scrollTo({ top: 0, behavior: 'smooth' });
        
        setTimeout(() => {
            alertDiv.classList.remove('show');
        }, 8000);
    }

    function showLoading(show) {
        loadingDiv.classList.toggle('show', show);
        cadastroForm.style.display = show ? 'none' : 'block';
    }

    document.getElementById('postalCode').addEventListener('blur', async function() {
        const cep = this.value.replace(/\D/g, '');
        if (cep.length === 8) {
            try {
                const response = await fetch(`https://viacep.com.br/ws/${cep}/json/`);
                const data = await response.json();
                if (!data.erro) {
                    document.getElementById('address').value = data.logradouro;
                    document.getElementById('city').value = data.localidade;
                    document.getElementById('state').value = data.uf;
                }
            } catch (error) {
                console.error('Erro ao buscar CEP:', error);
            }
        }
    });

    document.getElementById('phone').addEventListener('input', function(e) {
        let value = e.target.value.replace(/\D/g, '');
        if (value.length <= 11) {
            value = value.replace(/^(\d{2})(\d)/g, '($1) $2');
            value = value.replace(/(\d)(\d{4})$/, '$1-$2');
        }
        e.target.value = value;
    });

    document.getElementById('postalCode').addEventListener('input', function(e) {
        let value = e.target.value.replace(/\D/g, '');
        value = value.replace(/^(\d{5})(\d)/, '$1-$2');
        e.target.value = value;
    });

    document.getElementById('cpfCnpj').addEventListener('input', function(e) {
        let value = e.target.value.replace(/\D/g, '');
        if (value.length <= 11) {
            value = value.replace(/(\d{3})(\d)/, '$1.$2');
            value = value.replace(/(\d{3})(\d)/, '$1.$2');
            value = value.replace(/(\d{3})(\d{1,2})$/, '$1-$2');
        } else {
            value = value.replace(/^(\d{2})(\d)/, '$1.$2');
            value = value.replace(/^(\d{2})\.(\d{3})(\d)/, '$1.$2.$3');
            value = value.replace(/\.(\d{3})(\d)/, '.$1/$2');
            value = value.replace(/(\d{4})(\d)/, '$1-$2');
        }
        e.target.value = value;
    });

    cadastroForm.addEventListener('submit', async (e) => {
        e.preventDefault();
        showLoading(true);

        const formData = new FormData(cadastroForm);
        const data = {};
        formData.forEach((value, key) => {
            data[key] = value;
        });

        data.cpfCnpj = data.cpfCnpj.replace(/\D/g, '');
        data.phone = data.phone.replace(/\D/g, '');
        data.postalCode = data.postalCode.replace(/\D/g, '');

        try {
            const response = await fetch('https://n8n.timepulseai.com.br/webhook/cadastro_revendas', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json',
                },
                body: JSON.stringify(data)
            });

            if (!response.ok) {
                throw new Error('Erro ao cadastrar revendedor');
            }

            const result = await response.json();

            showAlert(
                '<strong>Cadastro realizado com sucesso!</strong><br>' +
                'Seus dados foram enviados para análise. Em breve você receberá um email com as instruções de acesso.',
                'success'
            );

            setTimeout(() => {
                window.location.href = 'loginrevenda.html';
            }, 3000);

        } catch (error) {
            console.error('Erro no cadastro:', error);
            showAlert(
                '<strong>Erro ao cadastrar!</strong><br>' +
                error.message || 'Ocorreu um erro ao processar seu cadastro. Tente novamente.',
                'danger'
            );
            showLoading(false);
        }
    });
</script>
</body>
</html>
