CREATE TABLE public.orders (
  id uuid NOT NULL DEFAULT gen_random_uuid(),
  restaurant_id uuid NOT NULL,
  customer_id uuid,
  deliverer_id uuid,
  status character varying DEFAULT 'novo'::character varying CHECK (status::text = ANY (ARRAY['novo'::character varying::text, 'aceito'::character varying::text, 'preparo'::character varying::text, 'pronto'::character varying::text, 'saiu_entrega'::character varying::text, 'entregue'::character varying::text, 'rejeitado'::character varying::text, 'cancelado'::character varying::text, 'Aberta'::character varying::text, 'encerrado'::character varying::text, 'aguardando'::character varying::text])),
  delivery_address text NOT NULL,
  delivery_coordinates point,
  delivery_fee numeric DEFAULT 0.00 CHECK (delivery_fee >= 0::numeric),
  subtotal numeric DEFAULT 0.00 CHECK (subtotal >= 0::numeric),
  total numeric DEFAULT 0.00 CHECK (total >= 0::numeric),
  notes text,
  customer_name character varying NOT NULL,
  customer_phone character varying NOT NULL,
  payment_method text CHECK (payment_method = ANY (ARRAY['money'::text, 'card'::text, 'card_debit'::text, 'card_credit'::text, 'pix'::text, 'voucher'::text, 'Cartão de Crédito/Débito'::text])),
  payment_status character varying DEFAULT 'pending'::character varying CHECK (payment_status::text = ANY (ARRAY['pending'::character varying::text, 'paid'::character varying::text, 'cancelled'::character varying::text, 'pago'::character varying::text])),
  change_for_amount numeric CHECK (change_for_amount IS NULL OR change_for_amount >= 0::numeric),
  change_amount numeric CHECK (change_amount IS NULL OR change_amount >= 0::numeric),
  estimated_delivery_time timestamp with time zone,
  accepted_at timestamp with time zone,
  prepared_at timestamp with time zone,
  delivered_at timestamp with time zone,
  created_at timestamp with time zone DEFAULT now(),
  updated_at timestamp with time zone DEFAULT now(),
  delivery_distance numeric,
  delivery_duration numeric,
  order type text,
  return order boolean,
  order_items text,
  order_balcao text,
  order_mesa text,
  status_env_aceito boolean,
  idpix text,
  CONSTRAINT orders_pkey PRIMARY KEY (id)
);